!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Geosuggest=e()}}(function(){var e;return function t(e,n,s){function u(i,r){if(!n[i]){if(!e[i]){var a="function"==typeof require&&require;if(!r&&a)return a(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return u(n?n:t)},c,c.exports,t,e,n,s)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<s.length;i++)u(s[i]);return u}({1:[function(t,n){!function(){"use strict";function t(){for(var e=[],n=0;n<arguments.length;n++){var u=arguments[n];if(u){var o=typeof u;if("string"===o||"number"===o)e.push(u);else if(Array.isArray(u))e.push(t.apply(null,u));else if("object"===o)for(var i in u)s.call(u,i)&&u[i]&&e.push(i)}}return e.join(" ")}var s={}.hasOwnProperty;"undefined"!=typeof n&&n.exports?n.exports=t:"function"==typeof e&&"object"==typeof e.amd&&e.amd?e("classnames",[],function(){return t}):window.classNames=t}()},{}],2:[function(e,t){function n(e,t,n){function s(t){var n=h,s=y;return h=y=void 0,_=t,m=e.apply(s,n)}function o(e){return _=e,b=setTimeout(c,t),j?s(e):m}function i(e){var n=e-P,s=e-_,u=t-n;return O?w(u,v-s):u}function l(e){var n=e-P,s=e-_;return!P||n>=t||0>n||O&&s>=v}function c(){var e=T();return l(e)?f(e):void(b=setTimeout(c,i(e)))}function f(e){return clearTimeout(b),b=void 0,I&&h?s(e):(h=y=void 0,m)}function p(){void 0!==b&&clearTimeout(b),P=_=0,h=y=b=void 0}function g(){return void 0===b?m:f(T())}function d(){var e=T(),n=l(e);if(h=arguments,y=this,P=e,n){if(void 0===b)return o(P);if(O)return clearTimeout(b),b=setTimeout(c,t),s(P)}return void 0===b&&(b=setTimeout(c,t)),m}var h,y,v,m,b,P=0,_=0,j=!1,O=!1,I=!0;if("function"!=typeof e)throw new TypeError(a);return t=r(t)||0,u(n)&&(j=!!n.leading,O="maxWait"in n,v=O?S(r(n.maxWait)||0,t):v,I="trailing"in n?!!n.trailing:I),d.cancel=p,d.flush=g,d}function s(e){var t=u(e)?b.call(e):"";return t==c||t==f}function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function o(e){return!!e&&"object"==typeof e}function i(e){return"symbol"==typeof e||o(e)&&b.call(e)==p}function r(e){if("number"==typeof e)return e;if(i(e))return l;if(u(e)){var t=s(e.valueOf)?e.valueOf():e;e=u(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(g,"");var n=h.test(e);return n||y.test(e)?v(e.slice(2),n?2:8):d.test(e)?l:+e}var a="Expected a function",l=0/0,c="[object Function]",f="[object GeneratorFunction]",p="[object Symbol]",g=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,y=/^0o[0-7]+$/i,v=parseInt,m=Object.prototype,b=m.toString,S=Math.max,w=Math.min,T=Date.now;t.exports=n},{}],3:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}Object.defineProperty(n,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),c=window.React,f=s(c),p=e("classnames"),g=s(p),d=e("lodash.debounce"),h=s(d),y=e("./defaults"),v=s(y),m=e("./prop-types"),b=s(m),S=e("./filter-input-attributes"),w=s(S),T=e("./input"),P=s(T),_=e("./suggest-list"),j=s(_),O=function(e){function t(e){u(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.state={isSuggestsHidden:!0,userInput:e.initialValue,activeSuggest:null,suggests:[],timer:null},n.onInputChange=n.onInputChange.bind(n),n.onAfterInputChange=n.onAfterInputChange.bind(n),e.queryDelay&&(n.onAfterInputChange=h["default"](n.onAfterInputChange,e.queryDelay)),n}return i(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){this.props.initialValue!==e.initialValue&&this.setState({userInput:e.initialValue})}},{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){clearTimeout(this.state.timer)}},{key:"onInputChange",value:function(e){this.setState({userInput:e},this.onAfterInputChange)}},{key:"onAfterInputChange",value:function(){this.showSuggests(),this.props.onChange(this.state.userInput)}},{key:"onInputFocus",value:function(){this.props.onFocus(),this.showSuggests()}},{key:"onInputBlur",value:function(){this.state.ignoreBlur||this.hideSuggests()}},{key:"focus",value:function(){this.refs.input.focus()}},{key:"update",value:function(e){this.setState({userInput:e}),this.props.onChange(e)}},{key:"clear",value:function(){var e=this;this.setState({userInput:""},function(){return e.hideSuggests()})}},{key:"searchSuggests",value:function(){var e=this;if(!this.state.userInput)return void this.updateSuggests();var t={query:this.state.userInput,output:"json",ak:"zaGZEDHau49KNhe4lQGs7f75"};["location","region"].forEach(function(n){e.props[n]&&(t[n]=e.props[n])}),window.$.ajax({type:"get",url:"http://api.map.baidu.com/place/v2/suggestion",data:t,dataType:"jsonp",jsonp:"callback",success:function(t){e.updateSuggests(0===t.status?t.result:[]),e.props.autoActivateFirstSuggest&&e.activateSuggest("next")},error:function(){e.updateSuggests([]),e.activateSuggest("next")}})}},{key:"updateSuggests",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n=[],s=new RegExp(r(this.state.userInput),"gim"),u=this.props.skipSuggest,o=10,i=0;this.props.fixtures.forEach(function(e){i>=o||!u(e)&&e.label.match(s)&&(i++,e.placeId=e.label,e.isFixture=!0,n.push(e))}),t.forEach(function(t){u(t)||n.push({label:e.props.getSuggestLabel(t),placeId:t.uid,isFixture:!1,location:t.location,city:{id:t.cityid,name:t.name},business:t.business,district:t.district})}),this.setState({suggests:n})}},{key:"showSuggests",value:function(){this.searchSuggests(),this.setState({isSuggestsHidden:!1})}},{key:"hideSuggests",value:function(){var e=this;this.props.onBlur(this.state.userInput);var t=setTimeout(function(){e.setState({isSuggestsHidden:!0})},100);this.setState({timer:t})}},{key:"activateSuggest",value:function(e){if(this.state.isSuggestsHidden)return void this.showSuggests();var t=this.state.suggests.length-1,n="next"===e,s=null,u=0,o=0;for(o;t>=o;o++)this.state.suggests[o]===this.state.activeSuggest&&(u=n?o+1:o-1);this.state.activeSuggest||(u=n?0:t),u>=0&&t>=u&&(s=this.state.suggests[u]),this.props.onActivateSuggest(s),this.setState({activeSuggest:s})}},{key:"selectSuggest",value:function(e){return e||(e={label:this.state.userInput}),this.setState({isSuggestsHidden:!0,userInput:e.label}),e.location?(this.setState({ignoreBlur:!1}),void this.props.onSuggestSelect(e)):void this.props.onSuggestSelect(e)}},{key:"render",value:function(){var e=this,t=w["default"](this.props),n=g["default"]("geosuggest",this.props.className),s=f["default"].createElement(P["default"],a({className:this.props.inputClassName,ref:"input",value:this.state.userInput,ignoreTab:this.props.ignoreTab,onChange:this.onInputChange,onFocus:this.onInputFocus.bind(this),onBlur:this.onInputBlur.bind(this),style:this.props.style.input,onNext:function(){return e.activateSuggest("next")},onPrev:function(){return e.activateSuggest("prev")},onSelect:function(){return e.selectSuggest(e.state.activeSuggest)},onEscape:this.hideSuggests.bind(this)},t)),u=f["default"].createElement(j["default"],{isHidden:this.state.isSuggestsHidden,style:this.props.style.suggests,suggestItemStyle:this.props.style.suggestItem,suggests:this.state.suggests,activeSuggest:this.state.activeSuggest,onSuggestMouseDown:function(){return e.setState({ignoreBlur:!0})},onSuggestMouseOut:function(){return e.setState({ignoreBlur:!1})},onSuggestSelect:this.selectSuggest.bind(this)});return f["default"].createElement("div",{className:n},f["default"].createElement("div",{className:"geosuggest__input-wrapper"},s),f["default"].createElement("div",{className:"geosuggest__suggests-wrapper"},u))}}]),t}(f["default"].Component);O.propTypes=b["default"],O.defaultProps=v["default"],n["default"]=O},{"./defaults":4,"./filter-input-attributes":5,"./input":6,"./prop-types":7,"./suggest-list":9,classnames:1,"lodash.debounce":2}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={fixtures:[],initialValue:"",placeholder:"搜索地名",disabled:!1,className:"",inputClassName:"",location:null,radius:null,bounds:null,country:null,types:null,queryDelay:250,googleMaps:null,onActivateSuggest:function(){},onSuggestSelect:function(){},onFocus:function(){},onBlur:function(){},onChange:function(){},skipSuggest:function(){},getSuggestLabel:function(e){return e.name},autoActivateFirstSuggest:!1,style:{input:{},suggests:{},suggestItem:{}},ignoreTab:!1}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e){var t={};return s.forEach(function(n){e[n]&&(t[n]=e[n])}),t};var s=["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","height","id","inputMode","maxLength","name","pattern","placeholder","readOnly","required","size","spellCheck","tabIndex"]},{}],6:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),l=window.React,c=s(l),f=e("classnames"),p=s(f),g=e("./filter-input-attributes"),d=s(g),h=function(e){function t(){return u(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),a(t,[{key:"onChange",value:function(){this.props.onChange(this.refs.input.value)}},{key:"onInputKeyDown",value:function(e){switch(e.which){case 40:e.preventDefault(),this.props.onNext();break;case 38:e.preventDefault(),this.props.onPrev();break;case 13:e.preventDefault(),this.props.onSelect();break;case 9:this.props.ignoreTab||this.props.onSelect();break;case 27:this.props.onEscape()}}},{key:"focus",value:function(){this.refs.input.focus()}},{key:"render",value:function(){var e=d["default"](this.props),t=p["default"]("geosuggest__input",this.props.className);return c["default"].createElement("input",r({className:t,ref:"input",type:"text",autoComplete:"off"},e,{value:this.props.value,style:this.props.style,onKeyDown:this.onInputKeyDown.bind(this),onChange:this.onChange.bind(this),onFocus:this.props.onFocus.bind(this),onBlur:this.props.onBlur.bind(this)}))}}]),t}(c["default"].Component);h.defaultProps={className:"",value:"",ignoreTab:!1,onChange:function(){},onFocus:function(){},onBlur:function(){},onNext:function(){},onPrev:function(){},onSelect:function(){},onEscape:function(){}},n["default"]=h},{"./filter-input-attributes":5,classnames:1}],7:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u=window.React,o=s(u);n["default"]={fixtures:o["default"].PropTypes.array,initialValue:o["default"].PropTypes.string,placeholder:o["default"].PropTypes.string,disabled:o["default"].PropTypes.bool,className:o["default"].PropTypes.string,inputClassName:o["default"].PropTypes.string,location:o["default"].PropTypes.object,radius:o["default"].PropTypes.oneOfType([o["default"].PropTypes.string,o["default"].PropTypes.number]),bounds:o["default"].PropTypes.object,country:o["default"].PropTypes.string,types:o["default"].PropTypes.array,queryDelay:o["default"].PropTypes.number,googleMaps:o["default"].PropTypes.object,onSuggestSelect:o["default"].PropTypes.func,onFocus:o["default"].PropTypes.func,onBlur:o["default"].PropTypes.func,onChange:o["default"].PropTypes.func,skipSuggest:o["default"].PropTypes.func,getSuggestLabel:o["default"].PropTypes.func,autoActivateFirstSuggest:o["default"].PropTypes.bool,style:o["default"].PropTypes.shape({input:o["default"].PropTypes.object,suggests:o["default"].PropTypes.object,suggestItem:o["default"].PropTypes.object}),ignoreTab:o["default"].PropTypes.bool}},{}],8:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u=window.React,o=s(u),i=e("classnames"),r=s(i);n["default"]=function(e){var t=e.isActive,n=void 0===t?!1:t,s=e.className,u=void 0===s?"":s,i=e.suggest,a=void 0===i?{}:i,l=e.onMouseDown,c=void 0===l?function(){}:l,f=e.onMouseOut,p=void 0===f?function(){}:f,g=e.onSelect,d=void 0===g?function(){}:g,h=e.style,y=void 0===h?{}:h,v=r["default"]("geosuggest-item",u,{"geosuggest-item--active":n});return o["default"].createElement("li",{className:v,style:y,onMouseDown:c,onMouseOut:p,onClick:function(e){e.preventDefault(),d()}},a.label)}},{classnames:1}],9:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u=window.React,o=s(u),i=e("classnames"),r=s(i),a=e("./suggest-item"),l=s(a);n["default"]=function(e){var t=e.isHidden,n=void 0===t?!0:t,s=e.suggests,u=void 0===s?[]:s,i=e.activeSuggest,a=e.onSuggestMouseDown,c=void 0===a?function(){}:a,f=e.onSuggestMouseOut,p=void 0===f?function(){}:f,g=e.onSuggestSelect,d=void 0===g?function(){}:g,h=e.style,y=void 0===h?{}:h,v=e.suggestItemStyle,m=void 0===v?{}:v,b=r["default"]("geosuggest__suggests",{"geosuggest__suggests--hidden":n||0===u.length});return o["default"].createElement("ul",{className:b,style:y},u.map(function(e){var t=i&&e.placeId===i.placeId;return o["default"].createElement(l["default"],{key:e.placeId,className:e.className,suggest:e,style:m,isActive:t,onMouseDown:c,onMouseOut:p,onSelect:function(){return d(e)}})}))}},{"./suggest-item":8,classnames:1}]},{},[3])(3)});